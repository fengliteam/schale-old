<!DOCTYPE html>
<html lang="zh-CN" itemscope itemtype="http://schema.org/WebSite">

{% include head.html %}

<!-- 内联关键CSS -->
<style>
:root {
    --primary: #2A5CAA;
    --accent: #5BC0EB;
    --text: #2C3E50;
}

/* 极速加载系统 */
body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    line-height: 1.7;
    color: var(--text);
    scroll-behavior: smooth;
}

/* 动态导航效果 */
.navbar {
    background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.nav-item {
    transition: transform 0.3s ease;
}

.nav-item:hover {
    transform: translateY(-2px);
}

/* 现代化页脚 */
.footer {
    background: rgba(16,33,54,0.95);
    backdrop-filter: blur(10px);
    border-top: 1px solid rgba(91,192,235,0.3);
}

/* 移动端优化 */
@media (max-width: 768px) {
    .navbar-collapse {
        background: rgba(255,255,255,0.95);
        backdrop-filter: blur(10px);
    }
}
</style>

<body ontouchstart="">
    <!-- 结构化数据 -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "沙勒避难所-S.C.H.A.L.E.",
        "url": "https://schale.us.kg",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://schale.us.kg/search?q={search_term}",
            "query-input": "required name=search_term"
        }
    }
    </script>

    {% include nav.html %}

    <main role="main">
        {{ content }}
    </main>

    {% include footer.html %}

    <!-- 全局交互优化 -->
    <script>
    // 平滑滚动增强
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // 触摸反馈优化
    document.addEventListener('touchstart', function() {}, {passive: true});
    </script>

    <!-- 智能图片系统 -->
    <script defer>
    window.addEventListener('load', () => {
        // WebP优先加载
        document.querySelectorAll('img').forEach(img => {
            if (!img.src.endsWith('.webp')) {
                img.src = img.src.replace(/\.(jpe?g|png)/i, '.webp');
            }
            img.loading = 'lazy';
        });

        // 首屏图片预加载
        const firstScreenImages = document.querySelectorAll('img[loading="eager"]');
        firstScreenImages.forEach(img => {
            const imgObj = new Image();
            imgObj.src = img.dataset.src || img.src;
        });
    });
    </script>
</body>
</html>
